<style>
	.ml-8{
		margin-left: -8px;
	}
	.ml8{
		margin-left: 8px;
	}
	.list-p{
		padding: 5px 15px;
	}
	.list-group-item:hover{
		z-index: 2;
		color: #fff;
		background-color: #007bff;
		border-color: #007bff;
	}
	.file {
	  visibility: hidden;
	  position: absolute;
	}
	background-text{
        font-size:30px;
        font-weight:600;
        color:#ccc;
        position:absolute;
        z-index:-1;
        margin: 15px 0 0 15px;
    }

</style>
<br><br><br>
<section id="cover" class="d-none">
     <div class="form-group row">
		<div class="col-sm-12 pl-0">
		 	<div id="cvrPreview" style="height: 350px;" class="shadow rounded">
		 		<background-text> Cover Image </background-text>
			    <input type="file" name="img[]" class="cvr-file file" accept="image/*">
			    <div class="input-group my-3 col-sm-3 float-right">
			      <input type="text" class="form-control" disabled placeholder="Upload File" id="cvrFile">
			      <div class="input-group-append">
			        <button type="button" class="cvr-browse btn btn-primary">Browse</button>
			      </div>
			    </div>
			   <div style="bottom: -60px; left: 100px;padding: 15px" class="position-absolute d-flex">
			   	<img src="/images/sqrimg250.png" id="proPreview" class="shadow rounded mr-2 bg-white w200">
			   	<input type="file" name="img[]" class="pro-file file" accept="image/*">
			    <div class="input-group">
			      <div class="">
			        <button type="button" class="pro-browse btn btn-primary"><i class="fa-solid fa-pen-to-square"></i></button>
			      </div>
			    </div>
			</div>
		    </div>
		</div>
    </div>
    <br><br><br>
</section>
<section>
	<h4 class="ml-8">Profile</h4>
	<br>
	<div class="row">
	    <div class="col-md-6">
	        <form>
				  
	            <div class="form-group row">
	                <label for="userName" class="form-control-sm col-sm-4">Username</label>
	                <input type="text" class="form-control form-control-sm col-sm-6" disabled id="userName" aria-describedby="Username">
	            </div>
	            <div class="form-group row">
	                <label for="name" class="form-control-sm form-control-sm col-sm-4">Name</label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="name" aria-describedby="Name">
	            </div>
	            <div class="form-group row">
	                <label for="phone" class="form-control-sm col-sm-4">Phone num </label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="phone" aria-describedby="phone">
	            </div>
	            <div class="form-group row">
	                <label for="email" class="form-control-sm col-sm-4">Email </label>
	                <input type="email" class="form-control form-control-sm col-sm-6" id="email" aria-describedby="Email">
	            </div>
	            <div class="form-group row">
	                <label for="location" class="form-control-sm col-sm-4">Farm location </label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="location" aria-describedby="Farm location">
	            </div>
	            <div class="form-group row">
	                <label for="nid" class="form-control-sm col-sm-4">NID </label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="nid" aria-describedby="NID">
	            </div>
	            <div class="form-group row">
	                <label for="tin" class="form-control-sm col-sm-4">TIN </label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="tin" aria-describedby="TIN">
	            </div>
				<div class="form-group row">
					<label for="updateUserdetails" class="form-control-sm col-sm-4"></label>
					<div class="col-sm-6 p-0">
	            		<button type="button" class="btn btn-primary float-right" id="updateUserdetails">Save</button>
	            	</div>
	            </div>
	        </form>
	    </div>
	
	    <div class="col-md-6 mx-auto">
	        <form>
	            <div class="form-group row">
	              <label for="newPassword" class="form-control-sm col-sm-4">New Password</label>
	              <input type="password" class="form-control form-control-sm col-sm-6" id="newPassword">
	            </div>
	            <div class="form-group row">
	              <label for="retypePassword" class="form-control-sm col-sm-4">Retype Password</label>
	              <input type="password" class="form-control form-control-sm col-sm-6" id="retypePassword">
	            </div>
				<div class="form-group row">
					<label for="updatePassword" class="form-control-sm col-sm-4"></label>
					<div class="col-sm-6 p-0">
	            		<button type="button" class="btn btn-primary float-right" id="updatePassword">Save</button>
	            	</div>
	            </div>
	          </form>
	    </div>
	</div>
</section>
<br><br>
<section id="shopExtras" class="d-none">
	<h4 class="ml-8">Category</h4>
	<br>
	<div class="row">
	    <div class="col-md-6">
	        <form id="catForm">
	            <div class="form-group row">
					<div class="col-sm-6 pl-0">
					  <div id="msg"></div>
					    <input type="file" name="img[]" class="cat-file file w90" accept="image/*">
					    <div class="input-group my-3">
					      <input type="text" class="form-control" disabled placeholder="Upload File" id="catFile">
					      <div class="input-group-append">
					        <button type="button" class="cat-browse btn btn-primary">Browse</button>
					      </div>
					    </div>
					</div>
					<div class="col-sm-4 pr-0">
					  <img src="/images/sqrimg80.png" id="catPreview" class="img-thumbnail float-right w90">
					</div>
	            </div>
	            <div class="form-group row">
	            	<input type="text" class="d-none" id="catId">
	            
	                <label for="catName" class="form-control-sm col-sm-4">Name</label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="catName" aria-describedby="catName">
	            </div>
	            <div class="form-group row">
	                <label for="catOrder" class="form-control-sm form-control-sm col-sm-4">Order no.</label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="catOrder" aria-describedby="catOrder">
	            </div>
	            <div class="form-group row">
				  <div class="form-group form-check col-sm-4 ml8">
				    <input type="checkbox" class="form-check-input mt-2" id="catStatusCheck">
				    <label class="form-check-label" for="catStatusCheck"><small>Deactivate</small></label>
				  </div>
					<div class="col-sm-6 p-0">
	            		<button type="button" class="btn btn-primary float-right" id="updateCategory">Save</button>
	            		<button type="button" class="btn btn-secondary float-right mr-2" id="catReset">Reset</button>
	            	</div>
	            </div>
	        </form>
	    </div>
	    <div class="col-md-6 mx-auto">
			<div class="list-group" id="catList"></div>
	    </div>
	</div>

	<br><br>

	<h4 class="ml-8">Item</h4>
	<br>
	<div class="row">
	    <div class="col-md-6">
	        <form id="itmForm">
	            <div class="form-group row">
					<div class="col-sm-6 pl-0">
					  <div id="msg"></div>
					    <input type="file" name="img[]" class="itm-file file" accept="image/*">
					    <div class="input-group my-3">
					      <input type="text" class="form-control" disabled placeholder="Upload File" id="itmFile">
					      <div class="input-group-append">
					        <button type="button" class="itm-browse btn btn-primary">Browse</button>
					      </div>
					    </div>
					</div>
					<div class="col-sm-4 pr-0">
					  <img src="/images/sqrimg250.png" id="itmPreview" class="img-thumbnail w175">
					</div>
	            </div>
				<div class="form-group row">
					<label for="itmName" class="form-control-sm col-sm-4">Category</label>
					<select class="custom-select custom-select-sm col-sm-6" id="categorySelect"></select>
				</div>
	            <div class="form-group row">
	            	<input type="text" class="d-none" id="itmId">
	            	
	                <label for="itmName" class="form-control-sm col-sm-4">Name</label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="itmName" aria-describedby="itmName">
	            </div>
	            <div class="form-group row">
	                <label for="itmDetail" class="form-control-sm col-sm-4">Detail</label>
	                <textarea class="form-control form-control-sm col-sm-6" id="itmDetail" aria-describedby="itmName"></textarea>
	            </div>
	            <div class="form-group row">
	                <label for="itmOrder" class="form-control-sm form-control-sm col-sm-4">Order no.</label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="itmOrder" aria-describedby="itmOrder">
	            </div>
	            <div class="form-group row">
	                <label for="itmPrice" class="form-control-sm form-control-sm col-sm-4">Price</label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="itmPrice" aria-describedby="itmPrice">
	            </div>
	            <div class="form-group row">
	                <label for="itmVat" class="form-control-sm form-control-sm col-sm-4">Vat rate</label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="itmVat" aria-describedby="itmVat">
	            </div>
	            <div class="form-group row">
	                <label for="itmDisc" class="form-control-sm form-control-sm col-sm-4">Discount rate</label>
	                <input type="text" class="form-control form-control-sm col-sm-6" id="itmDisc" aria-describedby="itmDisc">
	            </div>
	            <div class="form-group row">
				  <div class="form-group form-check col-sm-4 ml8">
				    <input type="checkbox" class="form-check-input mt-2" id="itmStatusCheck">
				    <label class="form-check-label" for="itmStatusCheck"><small>Deactivate</small></label>
				  </div>
					<div class="col-sm-6 p-0">
	            		<button type="button" class="btn btn-primary float-right" id="updateItem">Save</button>
	            		<button type="button" class="btn btn-secondary float-right mr-2" id="itmReset">Reset</button>
	            	</div>
	            </div>
	        </form>
	    </div>
	    <div class="col-md-6 mx-auto">
			<div class="list-group" id="itmList">
			</div>
	    </div>
	</div>
</section>
<script>
	$(document).on("click", ".cvr-browse", function() {
		  var file = $(this).parents().find(".cvr-file");
		  file.trigger("click");
	});
	$('.cvr-file').change(function(e) {
	  var fn = e.target.files[0].name;
	  $("#cvrFile").val(fn);

	  var reader = new FileReader();
	  reader.onload = function(e) {
	    $("#cvrPreview").css('background-image', 'url(' + e.target.result + ')');
	    
	    var filename = userDetails.id + userDetails.username+ "cover.png";
        var fd = new FormData();
        var files = $('.cvr-file')[0].files;

        if(files.length > 0){
           var file = renamedFile(files[0], filename);
           fd.append('file', file);
           
			var fileRequest = $.ajax({
				url: root + "/uploadtocloud",
				type: "POST",
				data: fd,
			    processData: false,
			    contentType: false,
				headers: {
	                "Authorization": 'Bearer ' + userDetails.accessToken
				},
			});

			fileRequest.done(function (data) {
				console.log(data.secure_url);
				var request = $.ajax({
					url: root + "/api/users/updatecover",
					type: "POST",
					data: JSON.stringify({
						imageCover: data.secure_url,
					}),
					headers: {
						'Accept': 'application/json',
						'Content-Type': 'application/json',
		                "Authorization": 'Bearer ' + userDetails.accessToken
					},
				});

				request.done(function (data) {
					alert(data.message);
					$("#cvrFile").val("");
				});

				request.fail(function (jqXHR, textStatus) {
					console.log(jqXHR);
				});
			});

			fileRequest.fail(function (jqXHR, textStatus) {
				console.log("File Request failed: " + jqXHR.responseJSON.message);
			});
        }

	  };
	  // read the image file as a data URL.
	  reader.readAsDataURL(this.files[0]);
	});
	$(document).on("click", ".pro-browse", function() {
		  var file = $(this).parents().find(".pro-file");
		  file.trigger("click");
	});
	$('.pro-file').change(function(e) {
	  //var fileName = e.target.files[0].name;
	 // $("#proFile").val(fileName);

	  var reader = new FileReader();
	  reader.onload = function(e) {
	    $("#proPreview").prop('src', e.target.result);
	    
	    var filename = userDetails.id + userDetails.username+ "profile.png";
        var fd = new FormData();
        var files = $('.pro-file')[0].files;

        if(files.length > 0){
           var file = renamedFile(files[0], filename);
           fd.append('file', file);
           
			var fileRequest = $.ajax({
				url: root + "/uploadtocloud",
				type: "POST",
				data: fd,
			    processData: false,
			    contentType: false,
				headers: {
	                "Authorization": 'Bearer ' + userDetails.accessToken
				},
			});

			fileRequest.done(function (data) {
				console.log(data.secure_url);
				var request = $.ajax({
					url: root + "/api/users/updateimage",
					type: "POST",
					data: JSON.stringify({
						image: data.secure_url,
					}),
					headers: {
						'Accept': 'application/json',
						'Content-Type': 'application/json',
		                "Authorization": 'Bearer ' + userDetails.accessToken
					},
				});

				request.done(function (data) {
					alert(data.message);
				});

				request.fail(function (jqXHR, textStatus) {
					console.log(jqXHR);
				});
			});

			fileRequest.fail(function (jqXHR, textStatus) {
				console.log("File Request failed: " + jqXHR.responseJSON.message);
			});
        }

	  };
	  // read the image file as a data URL.
	  reader.readAsDataURL(this.files[0]);
	});
	
	function getUser(){
    	var request = $.ajax({
			url: root + "/api/users",
			type: "GET",

			headers: {
				'Accept': 'application/json',
				'Content-Type': 'application/json',
                "Authorization": 'Bearer ' + userDetails.accessToken
			},
		});

		request.done(function (data) {
			console.log(">>>>>>");
			console.log(data);
		    $("#contents").find("#userName").val(data.username);
		    $("#contents").find("#name").val(data.name);
		    $("#contents").find("#phone").val(data.phone);
		    $("#contents").find("#email").val(data.email);
		    $("#contents").find("#location").val(data.location);
		    $("#contents").find("#nid").val(data.nid);
		    $("#contents").find("#tin").val(data.tin);
		    var imageCover = data.imageCover;
		    if(imageCover != null){
		    	$("#cvrPreview").css('background-image', 'url(' + imageCover +')');
		    }
			var image = data.image;
			if(image != null){
				$('#proPreview').prop("src", image);
			}

		    if(data.roles[0].name === "ROLE_MODERATOR")
		    {
		    	$("#shopExtras").removeClass("d-none");
		    	$("#cover").removeClass("d-none");
		    }
		});

		request.fail(function (jqXHR, textStatus) {
			alert("Request failed: " + jqXHR.responseJSON.message);
		});
	}
	getUser();
		
	$("#updateUserdetails").click(function () {
		var name = $("#contents").find("#name").val();
		var phone = $("#contents").find("#phone").val();
		var email = $("#contents").find("#email").val();
		var location = $("#contents").find("#location").val();
		var nid = $("#contents").find("#nid").val();
		var tin = $("#contents").find("#tin").val();

		var request = $.ajax({
			url: root + "/api/users",
			type: "POST",
			data: JSON.stringify({
				name: name,
				phone: phone,
				email: email,
				location: location,
				nid: nid,
				tin: tin,
			}),
			headers: {
				'Accept': 'application/json',
				'Content-Type': 'application/json',
                "Authorization": 'Bearer ' + userDetails.accessToken
			},
		});

		request.done(function (data) {
			alert(data.message);
		});

		request.fail(function (jqXHR, textStatus) {
			alert("Request failed: " + jqXHR.responseJSON.message);
		});
	});
	$("#updatePassword").click(function () {
		var newPassword = $("#contents").find("#newPassword").val();
		var retypePassword = $("#contents").find("#retypePassword").val();

		var request = $.ajax({
			url: root + "/api/users/updatepassword",
			type: "POST",
			data: JSON.stringify({
				newPassword: newPassword,
				retypePassword: retypePassword,
			}),
			headers: {
				'Accept': 'application/json',
				'Content-Type': 'application/json',
                "Authorization": 'Bearer ' + userDetails.accessToken
			},
		});

		request.done(function (data) {
			alert(data.message);
			$("#contents").find("#newPassword").val("");
			$("#contents").find("#retypePassword").val("");
		});

		request.fail(function (jqXHR, textStatus) {
			alert("Request failed: " + jqXHR.responseJSON.message);
		});
	});
	
	//category >>>>>>>>>>>>>>>
	
	$(document).on("click", ".cat-browse", function() {
	  var file = $(this).parents().find(".cat-file");
	  file.trigger("click");
	});
	$('.cat-file').change(function(e) {
	  var fileName = e.target.files[0].name;
	  $("#catFile").val(fileName);

	  var reader = new FileReader();
	  reader.onload = function(e) {
	    // get loaded data and render thumbnail.
	    document.getElementById("catPreview").src = e.target.result;
	  };
	  // read the image file as a data URL.
	  reader.readAsDataURL(this.files[0]);
	});
		$("#updateCategory").click(function () {

			var catFile = $("#catFile").val();
			var catName = $("#contents").find("#catName").val();
			var str = catName.toLowerCase().replace(/\s/g, '');
			var filename = userDetails.id + str+ ".png";
	        var fd = new FormData();
	        var files = $('.cat-file')[0].files;

	        if(files.length > 0){
	           var file = renamedFile(files[0], filename);
	           fd.append('file', file);
	           
				var fileRequest = $.ajax({
					url: root + "/uploadtocloud",
					type: "POST",
					data: fd,
				    processData: false,
				    contentType: false,
					headers: {
		                "Authorization": 'Bearer ' + userDetails.accessToken
					},
				});

				fileRequest.done(function (data) {
					console.log(data.secure_url);
					updateCategory(data.secure_url);
				});

				fileRequest.fail(function (jqXHR, textStatus) {
					console.log("File Request failed: " + jqXHR.responseJSON.message);
				});
	        }else{
		        updateCategory(catFile);
	        }
		});
		
		function updateCategory(image){
			var catId = $("#contents").find("#catId").val();
			var catName = $("#contents").find("#catName").val();
			var catOrder = $("#contents").find("#catOrder").val();
			var catStatusCheck = $("#contents").find("#catStatusCheck").is(":checked");
			
			if(catName !== "" && catOrder !== ""){
				var request = $.ajax({
					url: root + "/api/generics",
					type: "POST",
					data: JSON.stringify({
						id: catId,
						type: "category",
						name: catName,
						orderno: catOrder,
						status: catStatusCheck,
						shop: userDetails.id,
						image: image
					}),
					headers: {
						'Accept': 'application/json',
						'Content-Type': 'application/json',
		                "Authorization": 'Bearer ' + userDetails.accessToken
					},
				});

				request.done(function (data) {
					//alert(data.message);
					getCategories();
					$('#catForm').trigger("reset");
					$('#catPreview').prop("src", "/images/sqrimg80.png");
				});

				request.fail(function (jqXHR, textStatus) {
					alert("Request failed: " + jqXHR.responseJSON.message);
				});
			}
			else{
				alert("Name and Order no is required.");
			}
		}
		$("#catReset").click(function () {
			$('#catForm').trigger("reset");
			$('#catPreview').prop("src", "/images/sqrimg80.png");
		});
		function getCategories(){
	    	var request = $.ajax({
				url: root + "/api/generics/byshop",
				type: "POST",
				data: JSON.stringify({
					shop: userDetails.id,
				}),
				headers: {
					'Accept': 'application/json',
					'Content-Type': 'application/json',
	                "Authorization": 'Bearer ' + userDetails.accessToken
				},
			});

			request.done(function (data) {
			    $("#catList").html("");
			    $("#categorySelect").html("");
			    for(var i = 0; i < data.length; i++){
			    	var param = JSON.stringify(data[i]);
				    var html = "<button type='button' onclick='setCategory("+ param +")' class='list-group-item list-group-item-action list-p d-flex justify-content-between align-items-center "+ (data[i].status === 'true' ? 'text-muted': '')+"'><small>" + data[i].name + "</small><small class='badge badge-pill'>" + data[i].rowIndex + "</small></button>";
				    $("#catList").append(html);
				    
				    var html2 = "<option value='" + data[i].name + "'>" + data[i].name + "</option>";
				    $("#categorySelect").append(html2);
			    }
			    $("#categorySelect").change();
			});

			request.fail(function (jqXHR, textStatus) {
				alert("Request failed: " + jqXHR.responseJSON.message);
			});
		}
		getCategories();
		
		function setCategory(data){
			$("#contents").find("#catId").val(data.id);
			$("#contents").find("#catName").val(data.name);
			$("#contents").find("#catOrder").val(data.rowIndex);
			$("#contents").find("#statusCheck").prop('checked', data.status == "true" ? true : false);
			
			var fileName = data.image;
			if(fileName != null && fileName.length > 0){
				$('#catPreview').prop("src", fileName);
				$("#catFile").val(fileName);
			}else{
				$('#catPreview').prop("src", "/images/sqrimg80.png");
				$("#catFile").val("");
			}
		}
		
		//item >>>>>>>>>>>>>>>
		
		$(document).on("click", ".itm-browse", function() {
		  var file = $(this).parents().find(".itm-file");
		  file.trigger("click");
		});
		$('.itm-file').change(function(e) {
		  var fileName = e.target.files[0].name;
		  $("#itmFile").val(fileName);

		  var reader = new FileReader();
		  reader.onload = function(e) {
		    // get loaded data and render thumbnail.
		    document.getElementById("itmPreview").src = e.target.result;
		  };
		  // read the image file as a data URL.
		  reader.readAsDataURL(this.files[0]);
		});
		
		$("#updateItem").click(function () {

			var itmName = $("#contents").find("#itmName").val();
			var itmFile = $("#itmFile").val();
			var str = itmName.toLowerCase().replace(/\s/g, '');
			var filename = userDetails.id + str+ ".png";
			
	        var fd = new FormData();
	        var files = $('.itm-file')[0].files;

	        if(files.length > 0){
	           var file = renamedFile(files[0], filename);
	           fd.append('file', file);
	           
				var fileRequest = $.ajax({
					url: root + "/uploadtocloud",
					type: "POST",
					data: fd,
				    processData: false,
				    contentType: false,
					headers: {
		                "Authorization": 'Bearer ' + userDetails.accessToken
					},
				});

				fileRequest.done(function (data) {
					console.log(data.message);
					updateItem(data.secure_url);
				});

				fileRequest.fail(function (jqXHR, textStatus) {
					console.log("File Request failed: " + jqXHR.responseJSON.message);
				});
	        }else{
	        	updateItem(itmFile);
	        }
		});
		function updateItem(image){
			var itmId = $("#contents").find("#itmId").val();
			var categorySelect = $("#contents").find("#categorySelect").val();
			var itmName = $("#contents").find("#itmName").val();
			var itmDetail = $("#contents").find("#itmDetail").val();
			var itmOrder = $("#contents").find("#itmOrder").val();
			var itmPrice = $("#contents").find("#itmPrice").val();
			var itmVat = $("#contents").find("#itmVat").val();
			var itmDisc = $("#contents").find("#itmDisc").val();
			var itmStatusCheck = $("#contents").find("#itmStatusCheck").is(":checked");
			if(itmName !== "" && itmOrder !== ""){
				var request = $.ajax({
					url: root + "/api/items",
					type: "POST",
					data: JSON.stringify({
						id: itmId,
						category: categorySelect,
						name: itmName,
						detail: itmDetail,
						orderno: itmOrder,
						status: itmStatusCheck,
						price: itmPrice,
						discountRate: itmDisc,
						vatRate: itmVat,
						shop: userDetails.id,
						image: image
					}),
					headers: {
						'Accept': 'application/json',
						'Content-Type': 'application/json',
		                "Authorization": 'Bearer ' + userDetails.accessToken
					},
				});

				request.done(function (data) {
					//alert(data.message);
			        getItems();
					$('#itmForm').trigger("reset");
					$('#itmPreview').prop("src", "/images/sqrimg250.png");
					$("#categorySelect").change();
				});

				request.fail(function (jqXHR, textStatus) {
					alert("Request failed: " + jqXHR.responseJSON.message);
				});
			}
			else{
				alert("Name and Order no is requires.");
			}
		}
		$("#itmReset").click(function () {
			$('#itmForm').trigger("reset");
			$('#itmPreview').prop("src", "/images/sqrimg250.png");
		});
		function getItems(){
			var categorySelect = $("#contents").find("#categorySelect").val();
			console.log("categorySelect "+categorySelect);
	    	var request = $.ajax({
				url: root + "/api/items/bycategory",
				type: "POST",
				data: JSON.stringify({
					shop: userDetails.id,
					category: categorySelect
				}),
				headers: {
					'Accept': 'application/json',
					'Content-Type': 'application/json',
	                "Authorization": 'Bearer ' + userDetails.accessToken
				},
			});

			request.done(function (data) {
			    $("#itmList").html("");
			    for(var i = 0; i < data.length; i++){
			    	var param = JSON.stringify(data[i]);
				    var html = "<button type='button' onclick='setItem("+ param +")' class='list-group-item list-group-item-action list-p d-flex justify-content-between align-items-center "+ (data[i].status === 'true' ? 'text-muted': '')+"'><small>" + data[i].name + "</small><small>TK " + data[i].price + "</small><small class='badge badge-pill'>" + data[i].shortCode + "</small></button>";
				    $("#itmList").append(html);
			    }
			});

			request.fail(function (jqXHR, textStatus) {
				alert("Request failed: " + jqXHR.responseJSON.message);
			});
		}
		getItems();
		$("#contents").find("#categorySelect").on('change', function() {
			getItems();
		});
		
		function setItem(data){
			$("#contents").find("#itmId").val(data.id);
			$("#contents").find("#categorySelect").val(data.category);
			$("#contents").find("#itmName").val(data.name);
			$("#contents").find("#itmDetail").val(data.detail);
			$("#contents").find("#itmOrder").val(data.shortCode);
			$("#contents").find("#itmPrice").val(data.price);
			$("#contents").find("#itmVat").val(data.vatRate);
			$("#contents").find("#itmDisc").val(data.discountRate);
			$("#contents").find("#itmStatusCheck").prop('checked', data.status == "true" ? true : false);
			$("#contents").find("#itmPrice").val(data.price);
			
			var fileName = data.image;
			if(fileName != null && fileName.length > 0){
				$('#itmPreview').prop("src", data.image);
				$("#itmFile").val(fileName);
			}else{
				$('#itmPreview').prop("src", "/images/sqrimg250.png");
				$("#itmFile").val("");
			}
		}
		
		function renamedFile(originalFile, newName) {
		    return new File([originalFile], newName, {
		        type: originalFile.type,
		        lastModified: originalFile.lastModified,
		        size: originalFile.size
		    });
		}
</script>